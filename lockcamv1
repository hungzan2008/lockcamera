local fov = 25
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local Cam = game.Workspace.CurrentCamera

local FOVring = Drawing.new("Circle")
FOVring.Visible = false
FOVring.Thickness = 2
FOVring.Color = Color3.fromRGB(128, 0, 128) -- Màu tím
FOVring.Filled = false
FOVring.Radius = fov
FOVring.Position = Cam.ViewportSize / 2

local aimEnabled = false -- Trạng thái bật/tắt nhắm mục tiêu

-- Cập nhật vị trí hình tròn FOV
local function updateDrawings()
    FOVring.Position = Cam.ViewportSize / 2
end

-- Nhìn vào mục tiêu
local function lookAt(target)
    Cam.CFrame = CFrame.new(Cam.CFrame.Position, target)
end

-- Tìm người chơi gần nhất trong FOV
local function getClosestPlayerInFOV()
    local nearest, last = nil, math.huge
    local playerMousePos = Cam.ViewportSize / 2

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= Players.LocalPlayer then
            local head = player.Character and player.Character:FindFirstChild("Head")
            if head then
                local ePos, isVisible = Cam:WorldToViewportPoint(head.Position)
                local distance = (Vector2.new(ePos.X, ePos.Y) - playerMousePos).Magnitude

                if distance < last and isVisible and distance < fov then
                    last, nearest = distance, head.Position
                end
            end
        end
    end

    return nearest
end

-- Cập nhật khi bật tính năng
RunService.RenderStepped:Connect(function()
    updateDrawings()
    if aimEnabled then
        local target = getClosestPlayerInFOV()
        if target then
            lookAt(target)
        end
    end
end)

-- **Tạo GUI chỉ có 1 nút**
local ScreenGui = Instance.new("ScreenGui", game.Players.LocalPlayer:WaitForChild("PlayerGui"))
local Button = Instance.new("TextButton", ScreenGui)
Button.Size, Button.Position = UDim2.new(0, 100, 0, 50), UDim2.new(0.8, 0, 0.75, 0)
Button.BackgroundColor3, Button.TextScaled = Color3.fromRGB(255, 0, 0), true
Button.Text = "Off"

-- Chuyển đổi bật/tắt khi bấm nút
Button.MouseButton1Click:Connect(function()
    aimEnabled = not aimEnabled
    FOVring.Visible = aimEnabled
    Button.Text = aimEnabled and "On" or "Off"
    Button.BackgroundColor3 = aimEnabled and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
end)
